2025-11-11 01:57:52.844 [main] INFO  e.t.v.c.ConfigurationPropertiesTest - Starting ConfigurationPropertiesTest using Java 21.0.8 with PID 1492886 (started by ehuetadr in /home/ehuetadr/TFG/VotacionBC/backend-spring)
2025-11-11 01:57:52.860 [main] DEBUG e.t.v.c.ConfigurationPropertiesTest - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-11 01:57:52.861 [main] INFO  e.t.v.c.ConfigurationPropertiesTest - No active profile set, falling back to 1 default profile: "default"
2025-11-11 01:57:55.136 [main] INFO  es.tfg.votacion.service.AuthService - Initializing Authentication Service (Mock Mode)
2025-11-11 01:57:55.137 [main] DEBUG es.tfg.votacion.service.AuthService - Loading mock users from: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 01:57:55.158 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: juan.perez (role: Votante (voter), active: true)
2025-11-11 01:57:55.159 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: maria.gonzalez (role: Votante (voter), active: true)
2025-11-11 01:57:55.159 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: admin (role: Administrador (admin), active: true)
2025-11-11 01:57:55.160 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: auditor (role: Auditor (auditor), active: true)
2025-11-11 01:57:55.160 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: carlos.martin (role: Votante (voter), active: true)
2025-11-11 01:57:55.162 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: ana.rodriguez (role: Votante (voter), active: true)
2025-11-11 01:57:55.163 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: pedro.lopez (role: Administrador (admin), active: true)
2025-11-11 01:57:55.164 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: lucia.garcia (role: Votante (voter), active: false)
2025-11-11 01:57:55.165 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: test.user (role: Votante (voter), active: true)
2025-11-11 01:57:55.165 [main] INFO  es.tfg.votacion.service.AuthService - Loaded 9 mock users from /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 01:57:55.169 [main] DEBUG es.tfg.votacion.service.AuthService - JWT signing key initialized with HS256 algorithm
2025-11-11 01:57:55.170 [main] INFO  es.tfg.votacion.service.AuthService - JWT signing key initialized successfully
2025-11-11 01:57:55.171 [main] DEBUG es.tfg.votacion.service.AuthService - JWT issuer: votacion-blockchain-poc
2025-11-11 01:57:55.171 [main] DEBUG es.tfg.votacion.service.AuthService - JWT audience: voting-system
2025-11-11 01:57:55.171 [main] DEBUG es.tfg.votacion.service.AuthService - JWT expiration: 3600 seconds
2025-11-11 01:57:55.171 [main] DEBUG es.tfg.votacion.service.AuthService - Allowed roles: [voter, admin, auditor]
2025-11-11 01:57:55.171 [main] WARN  es.tfg.votacion.service.AuthService - Running in MOCK authentication mode - not suitable for production!
2025-11-11 01:57:55.189 [main] INFO  e.t.votacion.service.ElectionService - Initializing ElectionService with mock elections
2025-11-11 01:57:55.190 [main] INFO  e.t.votacion.service.ElectionService - Created 3 mock elections
2025-11-11 01:57:55.222 [main] INFO  e.tfg.votacion.service.FabricService - Initializing Hyperledger Fabric Gateway connection
2025-11-11 01:57:55.222 [main] INFO  e.tfg.votacion.service.FabricService - Attempting to connect to Fabric network...
2025-11-11 01:57:55.222 [main] DEBUG e.tfg.votacion.service.FabricService - Connection profile: /home/ehuetadr/fabric/fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.json
2025-11-11 01:57:55.222 [main] DEBUG e.tfg.votacion.service.FabricService - Wallet path: /home/ehuetadr/TFG/VotacionBC/backend-spring/wallet
2025-11-11 01:57:55.223 [main] DEBUG e.tfg.votacion.service.FabricService - User: appUser
2025-11-11 01:57:55.223 [main] DEBUG e.tfg.votacion.service.FabricService - Channel: electionchannel
2025-11-11 01:57:55.223 [main] DEBUG e.tfg.votacion.service.FabricService - Chaincode: electioncc
2025-11-11 01:57:55.223 [main] WARN  e.tfg.votacion.service.FabricService - Using MOCK Fabric connection for PoC development
2025-11-11 01:57:55.223 [main] WARN  e.tfg.votacion.service.FabricService - To use real Fabric connection, implement proper Gateway initialization
2025-11-11 01:57:55.223 [main] INFO  e.tfg.votacion.service.FabricService - Successfully connected to Hyperledger Fabric network
2025-11-11 01:57:55.259 [main] INFO  e.t.votacion.service.StorageService - Initializing Storage Service with AES-GCM encryption
2025-11-11 01:57:55.259 [main] DEBUG e.t.votacion.service.StorageService - Loading encryption key from keystore: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/keystore/keystore.json
2025-11-11 01:57:55.280 [main] DEBUG e.t.votacion.service.StorageService - Keystore loaded - algorithm: AES/GCM/NoPadding, key length: 256 bits
2025-11-11 01:57:55.282 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded and validated successfully
2025-11-11 01:57:55.282 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded successfully from keystore
2025-11-11 01:57:55.290 [main] INFO  e.t.votacion.service.StorageService - Storage directory initialized: /home/ehuetadr/TFG/VotacionBC/backend-spring/data/storage
2025-11-11 01:57:55.291 [main] DEBUG e.t.votacion.service.StorageService - Encryption algorithm: AES/GCM/NoPadding
2025-11-11 01:57:55.292 [main] DEBUG e.t.votacion.service.StorageService - Key length: 256 bits
2025-11-11 01:57:55.292 [main] DEBUG e.t.votacion.service.StorageService - IV length: 12 bytes
2025-11-11 01:57:55.293 [main] DEBUG e.t.votacion.service.StorageService - Tag length: 128 bits
2025-11-11 01:57:55.293 [main] INFO  e.t.votacion.service.StorageService - Automatic cleanup enabled - retention: 30 days
2025-11-11 01:57:55.994 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: f26b9e9f-9512-4abe-8980-53b303569922

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-11-11 01:57:56.008 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-11-11 01:57:56.079 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring Spring Security with JWT authentication
2025-11-11 01:57:56.093 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring CORS for development environment
2025-11-11 01:57:56.151 [main] INFO  e.tfg.votacion.config.SecurityConfig - Spring Security configured successfully
2025-11-11 01:57:56.782 [main] INFO  e.t.v.c.ConfigurationPropertiesTest - Started ConfigurationPropertiesTest in 4.703 seconds (process running for 6.64)
2025-11-11 01:57:58.159 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [es.tfg.votacion.service.FabricServiceTest]: FabricServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-11-11 01:57:58.180 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration es.tfg.votacion.Application for test class es.tfg.votacion.service.FabricServiceTest
2025-11-11 01:57:58.255 [main] INFO  e.t.v.service.FabricServiceTest - Starting FabricServiceTest using Java 21.0.8 with PID 1492886 (started by ehuetadr in /home/ehuetadr/TFG/VotacionBC/backend-spring)
2025-11-11 01:57:58.256 [main] DEBUG e.t.v.service.FabricServiceTest - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-11 01:57:58.257 [main] INFO  e.t.v.service.FabricServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-11-11 01:57:58.957 [main] INFO  es.tfg.votacion.service.AuthService - Initializing Authentication Service (Mock Mode)
2025-11-11 01:57:58.959 [main] DEBUG es.tfg.votacion.service.AuthService - Loading mock users from: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 01:57:58.961 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: juan.perez (role: Votante (voter), active: true)
2025-11-11 01:57:58.962 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: maria.gonzalez (role: Votante (voter), active: true)
2025-11-11 01:57:58.964 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: admin (role: Administrador (admin), active: true)
2025-11-11 01:57:58.964 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: auditor (role: Auditor (auditor), active: true)
2025-11-11 01:57:58.965 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: carlos.martin (role: Votante (voter), active: true)
2025-11-11 01:57:58.969 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: ana.rodriguez (role: Votante (voter), active: true)
2025-11-11 01:57:58.970 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: pedro.lopez (role: Administrador (admin), active: true)
2025-11-11 01:57:58.974 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: lucia.garcia (role: Votante (voter), active: false)
2025-11-11 01:57:58.975 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: test.user (role: Votante (voter), active: true)
2025-11-11 01:57:58.976 [main] INFO  es.tfg.votacion.service.AuthService - Loaded 9 mock users from /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 01:57:58.977 [main] DEBUG es.tfg.votacion.service.AuthService - JWT signing key initialized with HS256 algorithm
2025-11-11 01:57:58.977 [main] INFO  es.tfg.votacion.service.AuthService - JWT signing key initialized successfully
2025-11-11 01:57:58.978 [main] DEBUG es.tfg.votacion.service.AuthService - JWT issuer: votacion-blockchain-poc
2025-11-11 01:57:58.978 [main] DEBUG es.tfg.votacion.service.AuthService - JWT audience: voting-system
2025-11-11 01:57:58.978 [main] DEBUG es.tfg.votacion.service.AuthService - JWT expiration: 3600 seconds
2025-11-11 01:57:58.978 [main] DEBUG es.tfg.votacion.service.AuthService - Allowed roles: [voter, admin, auditor]
2025-11-11 01:57:58.980 [main] WARN  es.tfg.votacion.service.AuthService - Running in MOCK authentication mode - not suitable for production!
2025-11-11 01:57:58.985 [main] INFO  e.t.votacion.service.ElectionService - Initializing ElectionService with mock elections
2025-11-11 01:57:58.986 [main] INFO  e.t.votacion.service.ElectionService - Created 3 mock elections
2025-11-11 01:57:59.019 [main] INFO  e.tfg.votacion.service.FabricService - Initializing Hyperledger Fabric Gateway connection
2025-11-11 01:57:59.021 [main] INFO  e.tfg.votacion.service.FabricService - Attempting to connect to Fabric network...
2025-11-11 01:57:59.022 [main] DEBUG e.tfg.votacion.service.FabricService - Connection profile: /tmp/mock-connection.json
2025-11-11 01:57:59.028 [main] DEBUG e.tfg.votacion.service.FabricService - Wallet path: /tmp/mock-wallet
2025-11-11 01:57:59.029 [main] DEBUG e.tfg.votacion.service.FabricService - User: mockUser
2025-11-11 01:57:59.030 [main] DEBUG e.tfg.votacion.service.FabricService - Channel: mockchannel
2025-11-11 01:57:59.030 [main] DEBUG e.tfg.votacion.service.FabricService - Chaincode: mockcc
2025-11-11 01:57:59.032 [main] WARN  e.tfg.votacion.service.FabricService - Using MOCK Fabric connection for PoC development
2025-11-11 01:57:59.032 [main] WARN  e.tfg.votacion.service.FabricService - To use real Fabric connection, implement proper Gateway initialization
2025-11-11 01:57:59.033 [main] INFO  e.tfg.votacion.service.FabricService - Successfully connected to Hyperledger Fabric network
2025-11-11 01:57:59.092 [main] INFO  e.t.votacion.service.StorageService - Initializing Storage Service with AES-GCM encryption
2025-11-11 01:57:59.093 [main] DEBUG e.t.votacion.service.StorageService - Loading encryption key from keystore: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/keystore/keystore.json
2025-11-11 01:57:59.100 [main] DEBUG e.t.votacion.service.StorageService - Keystore loaded - algorithm: AES/GCM/NoPadding, key length: 256 bits
2025-11-11 01:57:59.100 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded and validated successfully
2025-11-11 01:57:59.100 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded successfully from keystore
2025-11-11 01:57:59.101 [main] INFO  e.t.votacion.service.StorageService - Storage directory initialized: /home/ehuetadr/TFG/VotacionBC/backend-spring/data/storage
2025-11-11 01:57:59.101 [main] DEBUG e.t.votacion.service.StorageService - Encryption algorithm: AES/GCM/NoPadding
2025-11-11 01:57:59.103 [main] DEBUG e.t.votacion.service.StorageService - Key length: 256 bits
2025-11-11 01:57:59.104 [main] DEBUG e.t.votacion.service.StorageService - IV length: 12 bytes
2025-11-11 01:57:59.104 [main] DEBUG e.t.votacion.service.StorageService - Tag length: 128 bits
2025-11-11 01:57:59.105 [main] INFO  e.t.votacion.service.StorageService - Automatic cleanup enabled - retention: 30 days
2025-11-11 01:57:59.335 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: e4ec3f5e-6bee-4952-99ac-cfefc613835f

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-11-11 01:57:59.336 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-11-11 01:57:59.339 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring Spring Security with JWT authentication
2025-11-11 01:57:59.343 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring CORS for development environment
2025-11-11 01:57:59.353 [main] INFO  e.tfg.votacion.config.SecurityConfig - Spring Security configured successfully
2025-11-11 01:57:59.597 [main] INFO  e.t.v.service.FabricServiceTest - Started FabricServiceTest in 1.399 seconds (process running for 9.456)
2025-11-11 01:57:59.661 [main] DEBUG e.tfg.votacion.service.FabricService - Verifying vote transaction: MOCK-TX-12345
2025-11-11 01:57:59.662 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, using mock verification
2025-11-11 01:57:59.663 [main] DEBUG e.tfg.votacion.service.FabricService - MOCK: Transaction MOCK-TX-12345 verification result: true
2025-11-11 01:57:59.664 [main] DEBUG e.tfg.votacion.service.FabricService - Verifying vote transaction: TX-election-001-67890
2025-11-11 01:57:59.664 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, using mock verification
2025-11-11 01:57:59.665 [main] DEBUG e.tfg.votacion.service.FabricService - MOCK: Transaction TX-election-001-67890 verification result: true
2025-11-11 01:57:59.666 [main] DEBUG e.tfg.votacion.service.FabricService - Verifying vote transaction: INVALID-ID
2025-11-11 01:57:59.667 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, using mock verification
2025-11-11 01:57:59.669 [main] DEBUG e.tfg.votacion.service.FabricService - MOCK: Transaction INVALID-ID verification result: false
2025-11-11 01:57:59.669 [main] DEBUG e.tfg.votacion.service.FabricService - Verifying vote transaction: null
2025-11-11 01:57:59.669 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, using mock verification
2025-11-11 01:57:59.669 [main] DEBUG e.tfg.votacion.service.FabricService - MOCK: Transaction null verification result: false
2025-11-11 01:57:59.696 [main] INFO  e.tfg.votacion.service.FabricService - Emitting vote commitment to blockchain - Election: integration-test-election, Commitment: integration-test-commitment
2025-11-11 01:57:59.697 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning mock transaction ID
2025-11-11 01:57:59.697 [main] DEBUG e.tfg.votacion.service.FabricService - Verifying vote transaction: MOCK-TX-integration-test-election-1762822679697
2025-11-11 01:57:59.698 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, using mock verification
2025-11-11 01:57:59.699 [main] DEBUG e.tfg.votacion.service.FabricService - MOCK: Transaction MOCK-TX-integration-test-election-1762822679697 verification result: true
2025-11-11 01:57:59.699 [main] DEBUG e.tfg.votacion.service.FabricService - Querying election status: integration-test-election
2025-11-11 01:57:59.700 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning default status
2025-11-11 01:57:59.700 [main] INFO  e.tfg.votacion.service.FabricService - Counting votes from blockchain for election: integration-test-election
2025-11-11 01:57:59.701 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning mock results
2025-11-11 01:57:59.719 [main] INFO  e.tfg.votacion.service.FabricService - Counting votes from blockchain for election: test-election-003
2025-11-11 01:57:59.719 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning mock results
2025-11-11 01:57:59.756 [main] INFO  e.tfg.votacion.service.FabricService - Closing election on blockchain: test-election-002
2025-11-11 01:57:59.757 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning mock result
2025-11-11 01:57:59.858 [main] DEBUG e.tfg.votacion.service.FabricService - Querying election status: test-election-004
2025-11-11 01:57:59.859 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning default status
2025-11-11 01:57:59.913 [main] INFO  e.tfg.votacion.service.FabricService - Emitting vote commitment to blockchain - Election: test-election-001, Commitment: abc123def456
2025-11-11 01:57:59.914 [main] WARN  e.tfg.votacion.service.FabricService - No blockchain connection available, returning mock transaction ID
2025-11-11 01:57:59.959 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [es.tfg.votacion.service.StorageServiceTest]: StorageServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-11-11 01:57:59.965 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration es.tfg.votacion.Application for test class es.tfg.votacion.service.StorageServiceTest
2025-11-11 01:58:00.139 [main] INFO  e.t.v.service.StorageServiceTest - Starting StorageServiceTest using Java 21.0.8 with PID 1492886 (started by ehuetadr in /home/ehuetadr/TFG/VotacionBC/backend-spring)
2025-11-11 01:58:00.139 [main] DEBUG e.t.v.service.StorageServiceTest - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-11 01:58:00.139 [main] INFO  e.t.v.service.StorageServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-11-11 01:58:00.717 [main] INFO  es.tfg.votacion.service.AuthService - Initializing Authentication Service (Mock Mode)
2025-11-11 01:58:00.717 [main] DEBUG es.tfg.votacion.service.AuthService - Loading mock users from: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 01:58:00.719 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: juan.perez (role: Votante (voter), active: true)
2025-11-11 01:58:00.719 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: maria.gonzalez (role: Votante (voter), active: true)
2025-11-11 01:58:00.720 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: admin (role: Administrador (admin), active: true)
2025-11-11 01:58:00.720 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: auditor (role: Auditor (auditor), active: true)
2025-11-11 01:58:00.721 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: carlos.martin (role: Votante (voter), active: true)
2025-11-11 01:58:00.722 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: ana.rodriguez (role: Votante (voter), active: true)
2025-11-11 01:58:00.723 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: pedro.lopez (role: Administrador (admin), active: true)
2025-11-11 01:58:00.726 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: lucia.garcia (role: Votante (voter), active: false)
2025-11-11 01:58:00.727 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: test.user (role: Votante (voter), active: true)
2025-11-11 01:58:00.727 [main] INFO  es.tfg.votacion.service.AuthService - Loaded 9 mock users from /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 01:58:00.727 [main] DEBUG es.tfg.votacion.service.AuthService - JWT signing key initialized with HS256 algorithm
2025-11-11 01:58:00.727 [main] INFO  es.tfg.votacion.service.AuthService - JWT signing key initialized successfully
2025-11-11 01:58:00.729 [main] DEBUG es.tfg.votacion.service.AuthService - JWT issuer: votacion-blockchain-poc
2025-11-11 01:58:00.729 [main] DEBUG es.tfg.votacion.service.AuthService - JWT audience: voting-system
2025-11-11 01:58:00.729 [main] DEBUG es.tfg.votacion.service.AuthService - JWT expiration: 3600 seconds
2025-11-11 01:58:00.730 [main] DEBUG es.tfg.votacion.service.AuthService - Allowed roles: [voter, admin, auditor]
2025-11-11 01:58:00.730 [main] WARN  es.tfg.votacion.service.AuthService - Running in MOCK authentication mode - not suitable for production!
2025-11-11 01:58:00.733 [main] INFO  e.t.votacion.service.ElectionService - Initializing ElectionService with mock elections
2025-11-11 01:58:00.734 [main] INFO  e.t.votacion.service.ElectionService - Created 3 mock elections
2025-11-11 01:58:00.746 [main] INFO  e.tfg.votacion.service.FabricService - Initializing Hyperledger Fabric Gateway connection
2025-11-11 01:58:00.747 [main] INFO  e.tfg.votacion.service.FabricService - Attempting to connect to Fabric network...
2025-11-11 01:58:00.747 [main] DEBUG e.tfg.votacion.service.FabricService - Connection profile: /home/ehuetadr/fabric/fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.json
2025-11-11 01:58:00.747 [main] DEBUG e.tfg.votacion.service.FabricService - Wallet path: /home/ehuetadr/TFG/VotacionBC/backend-spring/wallet
2025-11-11 01:58:00.747 [main] DEBUG e.tfg.votacion.service.FabricService - User: appUser
2025-11-11 01:58:00.747 [main] DEBUG e.tfg.votacion.service.FabricService - Channel: electionchannel
2025-11-11 01:58:00.747 [main] DEBUG e.tfg.votacion.service.FabricService - Chaincode: electioncc
2025-11-11 01:58:00.748 [main] WARN  e.tfg.votacion.service.FabricService - Using MOCK Fabric connection for PoC development
2025-11-11 01:58:00.748 [main] WARN  e.tfg.votacion.service.FabricService - To use real Fabric connection, implement proper Gateway initialization
2025-11-11 01:58:00.748 [main] INFO  e.tfg.votacion.service.FabricService - Successfully connected to Hyperledger Fabric network
2025-11-11 01:58:00.767 [main] INFO  e.t.votacion.service.StorageService - Initializing Storage Service with AES-GCM encryption
2025-11-11 01:58:00.774 [main] DEBUG e.t.votacion.service.StorageService - Loading encryption key from keystore: src/main/resources/keystore/keystore.json
2025-11-11 01:58:00.775 [main] DEBUG e.t.votacion.service.StorageService - Keystore loaded - algorithm: AES/GCM/NoPadding, key length: 256 bits
2025-11-11 01:58:00.776 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded and validated successfully
2025-11-11 01:58:00.776 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded successfully from keystore
2025-11-11 01:58:00.785 [main] INFO  e.t.votacion.service.StorageService - Storage directory initialized: /tmp/votacion-test-storage
2025-11-11 01:58:00.785 [main] DEBUG e.t.votacion.service.StorageService - Encryption algorithm: AES/GCM/NoPadding
2025-11-11 01:58:00.786 [main] DEBUG e.t.votacion.service.StorageService - Key length: 256 bits
2025-11-11 01:58:00.786 [main] DEBUG e.t.votacion.service.StorageService - IV length: 12 bytes
2025-11-11 01:58:00.786 [main] DEBUG e.t.votacion.service.StorageService - Tag length: 128 bits
2025-11-11 01:58:00.786 [main] WARN  e.t.votacion.service.StorageService - Automatic cleanup is disabled
2025-11-11 01:58:01.067 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 99a125bc-8253-4e9e-970b-b98b7394fa95

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-11-11 01:58:01.069 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-11-11 01:58:01.077 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring Spring Security with JWT authentication
2025-11-11 01:58:01.078 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring CORS for development environment
2025-11-11 01:58:01.093 [main] INFO  e.tfg.votacion.config.SecurityConfig - Spring Security configured successfully
2025-11-11 01:58:01.323 [main] INFO  e.t.v.service.StorageServiceTest - Started StorageServiceTest in 1.315 seconds (process running for 11.181)
2025-11-11 01:58:01.359 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:01.360 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:01.447 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:01.447 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:01.450 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681359-1461422e.enc
2025-11-11 01:58:01.451 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 97de76c01944f5897caecea70a239315851ff9bb93a7a3de96eeb692398fe845
2025-11-11 01:58:01.468 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:01.468 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:01.469 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:01.469 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:01.470 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681468-ba7894c9.enc
2025-11-11 01:58:01.471 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 5bc8610f20c6c8273762f9b41442d9d27ff510f275c50e825faeb6a292abbc4a
2025-11-11 01:58:01.471 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822681468-ba7894c9
2025-11-11 01:58:01.479 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 65 bytes
2025-11-11 01:58:01.479 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 65 bytes
2025-11-11 01:58:01.489 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 37 bytes
2025-11-11 01:58:01.489 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822681468-ba7894c9 (37 bytes)
2025-11-11 01:58:01.523 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (1024 bytes)
2025-11-11 01:58:01.524 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 1024 bytes
2025-11-11 01:58:01.526 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 1052 bytes (IV: 12, encrypted: 1040)
2025-11-11 01:58:01.527 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 1052 bytes
2025-11-11 01:58:01.558 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681524-73ee365e.enc
2025-11-11 01:58:01.559 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 947891d9e5e1377976e9b6011cc8672579a8a034c3acb2e740c041ca73586930
2025-11-11 01:58:01.559 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822681524-73ee365e
2025-11-11 01:58:01.560 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 1052 bytes
2025-11-11 01:58:01.561 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 1052 bytes
2025-11-11 01:58:01.572 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 1024 bytes
2025-11-11 01:58:01.573 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822681524-73ee365e (1024 bytes)
2025-11-11 01:58:01.600 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (30890 bytes)
2025-11-11 01:58:01.600 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 30890 bytes
2025-11-11 01:58:01.618 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 30918 bytes (IV: 12, encrypted: 30906)
2025-11-11 01:58:01.618 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 30918 bytes
2025-11-11 01:58:01.628 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681600-189947ce.enc
2025-11-11 01:58:01.635 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: ab1675a5cce5784ec6c9516591b4a38147d156ac629b5a9f9713938198bbd820
2025-11-11 01:58:01.635 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822681600-189947ce
2025-11-11 01:58:01.636 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 30918 bytes
2025-11-11 01:58:01.636 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 30918 bytes
2025-11-11 01:58:01.640 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 30890 bytes
2025-11-11 01:58:01.640 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822681600-189947ce (30890 bytes)
2025-11-11 01:58:01.673 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:01.674 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:01.675 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:01.675 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:01.681 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681674-13b499c3.enc
2025-11-11 01:58:01.688 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: b1676669bab04a2fa0519f7295f8e703c59d293bb47b997dfe4f30adea7b554d
2025-11-11 01:58:01.689 [main] INFO  e.t.votacion.service.StorageService - Deleting blob: BLOB-test-election-001-1762822681674-13b499c3
2025-11-11 01:58:01.697 [main] INFO  e.t.votacion.service.StorageService - Blob deleted securely: BLOB-test-election-001-1762822681674-13b499c3
2025-11-11 01:58:01.743 [main] INFO  e.t.votacion.service.StorageService - Deleting blob: non-existent-blob-id
2025-11-11 01:58:01.744 [main] ERROR e.t.votacion.service.StorageService - Error searching for blob non-existent-blob-id: /tmp/votacion-test-storage
2025-11-11 01:58:01.745 [main] WARN  e.t.votacion.service.StorageService - Blob not found for deletion: non-existent-blob-id
2025-11-11 01:58:01.758 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:01.759 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:01.760 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:01.772 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:01.800 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681759-107e33fa.enc
2025-11-11 01:58:01.800 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 6de2cc0baa2d4036354a01da137494512fcd8d6ece9a7f2f20b488df46c33762
2025-11-11 01:58:01.820 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (20 bytes)
2025-11-11 01:58:01.820 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 20 bytes
2025-11-11 01:58:01.821 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 48 bytes (IV: 12, encrypted: 36)
2025-11-11 01:58:01.834 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 48 bytes
2025-11-11 01:58:01.851 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681820-62d22d4e.enc
2025-11-11 01:58:01.852 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 0add88664cdc1ed1cd00fce21bad1cdce46df1f32c71b0d5a5a35c1b611068ef
2025-11-11 01:58:01.852 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (20 bytes)
2025-11-11 01:58:01.852 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 20 bytes
2025-11-11 01:58:01.853 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 48 bytes (IV: 12, encrypted: 36)
2025-11-11 01:58:01.853 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 48 bytes
2025-11-11 01:58:01.898 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681852-1442a0a3.enc
2025-11-11 01:58:01.899 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 9530f6e69defd71d9f3c2737be52da5fc9fc7b8017676a3637bbe522e6dc3ecf
2025-11-11 01:58:01.899 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (20 bytes)
2025-11-11 01:58:01.900 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 20 bytes
2025-11-11 01:58:01.901 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 48 bytes (IV: 12, encrypted: 36)
2025-11-11 01:58:01.901 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 48 bytes
2025-11-11 01:58:01.902 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822681899-485708f6.enc
2025-11-11 01:58:01.902 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: d150811e41eeaaa7a5aec3ed6431c87183bfaca8d3ad554800f093771a17b8f6
2025-11-11 01:58:01.904 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822681820-62d22d4e
2025-11-11 01:58:01.905 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 48 bytes
2025-11-11 01:58:01.916 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 48 bytes
2025-11-11 01:58:01.917 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 20 bytes
2025-11-11 01:58:01.917 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822681820-62d22d4e (20 bytes)
2025-11-11 01:58:01.917 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822681852-1442a0a3
2025-11-11 01:58:01.918 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 48 bytes
2025-11-11 01:58:01.919 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 48 bytes
2025-11-11 01:58:01.919 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 20 bytes
2025-11-11 01:58:01.919 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822681852-1442a0a3 (20 bytes)
2025-11-11 01:58:01.919 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822681899-485708f6
2025-11-11 01:58:01.920 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 48 bytes
2025-11-11 01:58:01.921 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 48 bytes
2025-11-11 01:58:01.921 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 20 bytes
2025-11-11 01:58:01.921 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822681899-485708f6 (20 bytes)
2025-11-11 01:58:02.007 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: non-existent-blob-id
2025-11-11 01:58:02.010 [main] ERROR e.t.votacion.service.StorageService - Error searching for blob non-existent-blob-id: /tmp/votacion-test-storage
2025-11-11 01:58:02.012 [main] ERROR e.t.votacion.service.StorageService - Blob not found: non-existent-blob-id
2025-11-11 01:58:02.012 [main] ERROR e.t.votacion.service.StorageService - Failed to load and decrypt blob non-existent-blob-id: Blob not found: non-existent-blob-id
java.lang.RuntimeException: Blob not found: non-existent-blob-id
	at es.tfg.votacion.service.StorageService.loadDecrypted(StorageService.java:170)
	at es.tfg.votacion.service.StorageServiceTest.lambda$shouldThrowExceptionForNonExistentBlob$4(StorageServiceTest.java:279)
	at org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:53)
	at org.junit.jupiter.api.AssertThrows.assertThrows(AssertThrows.java:39)
	at org.junit.jupiter.api.Assertions.assertThrows(Assertions.java:3153)
	at es.tfg.votacion.service.StorageServiceTest.shouldThrowExceptionForNonExistentBlob(StorageServiceTest.java:278)
	at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103)
	at java.base/java.lang.reflect.Method.invoke(Method.java:580)
	at org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:775)
	at org.junit.platform.commons.support.ReflectionSupport.invokeMethod(ReflectionSupport.java:479)
	at org.junit.jupiter.engine.execution.MethodInvocation.proceed(MethodInvocation.java:60)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$ValidatingInvocation.proceed(InvocationInterceptorChain.java:131)
	at org.junit.jupiter.engine.extension.TimeoutExtension.intercept(TimeoutExtension.java:161)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestableMethod(TimeoutExtension.java:152)
	at org.junit.jupiter.engine.extension.TimeoutExtension.interceptTestMethod(TimeoutExtension.java:91)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker$ReflectiveInterceptorCall.lambda$ofVoidMethod$0(InterceptingExecutableInvoker.java:112)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.lambda$invoke$0(InterceptingExecutableInvoker.java:94)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain$InterceptedInvocation.proceed(InvocationInterceptorChain.java:106)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.proceed(InvocationInterceptorChain.java:64)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.chainAndInvoke(InvocationInterceptorChain.java:45)
	at org.junit.jupiter.engine.execution.InvocationInterceptorChain.invoke(InvocationInterceptorChain.java:37)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:93)
	at org.junit.jupiter.engine.execution.InterceptingExecutableInvoker.invoke(InterceptingExecutableInvoker.java:87)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.lambda$invokeTestMethod$7(TestMethodTestDescriptor.java:216)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.invokeTestMethod(TestMethodTestDescriptor.java:212)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:137)
	at org.junit.jupiter.engine.descriptor.TestMethodTestDescriptor.execute(TestMethodTestDescriptor.java:69)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:156)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at java.base/java.util.ArrayList.forEach(ArrayList.java:1596)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:41)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$6(NodeTestTask.java:160)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:146)
	at org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$9(NodeTestTask.java:144)
	at org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:143)
	at org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:100)
	at org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:35)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)
	at org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:54)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:201)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:170)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:94)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.lambda$execute$0(EngineExecutionOrchestrator.java:59)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.withInterceptedStreams(EngineExecutionOrchestrator.java:142)
	at org.junit.platform.launcher.core.EngineExecutionOrchestrator.execute(EngineExecutionOrchestrator.java:58)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:103)
	at org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:85)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.junit.platform.launcher.core.InterceptingLauncher.lambda$execute$1(InterceptingLauncher.java:39)
	at org.junit.platform.launcher.core.ClasspathAlignmentCheckingLauncherInterceptor.intercept(ClasspathAlignmentCheckingLauncherInterceptor.java:25)
	at org.junit.platform.launcher.core.InterceptingLauncher.execute(InterceptingLauncher.java:38)
	at org.junit.platform.launcher.core.DelegatingLauncher.execute(DelegatingLauncher.java:47)
	at org.apache.maven.surefire.junitplatform.LauncherAdapter.executeWithoutCancellationToken(LauncherAdapter.java:60)
	at org.apache.maven.surefire.junitplatform.LauncherAdapter.execute(LauncherAdapter.java:52)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.execute(JUnitPlatformProvider.java:203)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:168)
	at org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:136)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:385)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:162)
	at org.apache.maven.surefire.booter.ForkedBooter.run(ForkedBooter.java:507)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:495)
2025-11-11 01:58:02.042 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:02.043 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:02.043 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:02.043 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:02.146 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822682043-4869b070.enc
2025-11-11 01:58:02.146 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 89226ce4dc8f7667f0f7a83113a4033033ceaec5a92d3c1c4e49da2f3a1ab76a
2025-11-11 01:58:02.169 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:02.170 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:02.170 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:02.171 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:02.370 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822682170-692b572f.enc
2025-11-11 01:58:02.371 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 8544e878404bf65016a6bcd9fd7108551d1f9bd452227a15da8c2881e1f978c0
2025-11-11 01:58:02.371 [main] INFO  e.t.votacion.service.StorageService - Storing encrypted data for election: test-election-001 (37 bytes)
2025-11-11 01:58:02.371 [main] DEBUG e.t.votacion.service.StorageService - Encrypting data with AES-GCM - input size: 37 bytes
2025-11-11 01:58:02.371 [main] DEBUG e.t.votacion.service.StorageService - Encryption complete - output size: 65 bytes (IV: 12, encrypted: 53)
2025-11-11 01:58:02.372 [main] DEBUG e.t.votacion.service.StorageService - Data encrypted successfully - size: 65 bytes
2025-11-11 01:58:02.377 [main] INFO  e.t.votacion.service.StorageService - Encrypted blob stored successfully: BLOB-test-election-001-1762822682371-e6d43752.enc
2025-11-11 01:58:02.377 [main] DEBUG e.t.votacion.service.StorageService - Blob SHA-256 hash: 299955a2c4fff768edb494c689134383e93c2b2fc79a16cb5833a2a9f20d598a
2025-11-11 01:58:02.378 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822682170-692b572f
2025-11-11 01:58:02.379 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 65 bytes
2025-11-11 01:58:02.379 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 65 bytes
2025-11-11 01:58:02.380 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 37 bytes
2025-11-11 01:58:02.380 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822682170-692b572f (37 bytes)
2025-11-11 01:58:02.380 [main] INFO  e.t.votacion.service.StorageService - Loading and decrypting blob: BLOB-test-election-001-1762822682371-e6d43752
2025-11-11 01:58:02.380 [main] DEBUG e.t.votacion.service.StorageService - Encrypted blob loaded - size: 65 bytes
2025-11-11 01:58:02.380 [main] DEBUG e.t.votacion.service.StorageService - Decrypting data with AES-GCM - input size: 65 bytes
2025-11-11 01:58:02.381 [main] DEBUG e.t.votacion.service.StorageService - Decryption complete - output size: 37 bytes
2025-11-11 01:58:02.381 [main] INFO  e.t.votacion.service.StorageService - Blob decrypted successfully: BLOB-test-election-001-1762822682371-e6d43752 (37 bytes)
2025-11-11 01:58:02.422 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [es.tfg.votacion.service.AuthServiceTest]: AuthServiceTest does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-11-11 01:58:02.424 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration es.tfg.votacion.Application for test class es.tfg.votacion.service.AuthServiceTest
2025-11-11 01:58:02.549 [main] INFO  e.t.votacion.service.AuthServiceTest - Starting AuthServiceTest using Java 21.0.8 with PID 1492886 (started by ehuetadr in /home/ehuetadr/TFG/VotacionBC/backend-spring)
2025-11-11 01:58:02.550 [main] DEBUG e.t.votacion.service.AuthServiceTest - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-11 01:58:02.550 [main] INFO  e.t.votacion.service.AuthServiceTest - No active profile set, falling back to 1 default profile: "default"
2025-11-11 01:58:03.206 [main] INFO  es.tfg.votacion.service.AuthService - Initializing Authentication Service (Mock Mode)
2025-11-11 01:58:03.206 [main] DEBUG es.tfg.votacion.service.AuthService - Loading mock users from: src/main/resources/mock/users.json
2025-11-11 01:58:03.208 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: juan.perez (role: Votante (voter), active: true)
2025-11-11 01:58:03.208 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: maria.gonzalez (role: Votante (voter), active: true)
2025-11-11 01:58:03.209 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: admin (role: Administrador (admin), active: true)
2025-11-11 01:58:03.209 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: auditor (role: Auditor (auditor), active: true)
2025-11-11 01:58:03.209 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: carlos.martin (role: Votante (voter), active: true)
2025-11-11 01:58:03.209 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: ana.rodriguez (role: Votante (voter), active: true)
2025-11-11 01:58:03.210 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: pedro.lopez (role: Administrador (admin), active: true)
2025-11-11 01:58:03.210 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: lucia.garcia (role: Votante (voter), active: false)
2025-11-11 01:58:03.210 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: test.user (role: Votante (voter), active: true)
2025-11-11 01:58:03.211 [main] INFO  es.tfg.votacion.service.AuthService - Loaded 9 mock users from src/main/resources/mock/users.json
2025-11-11 01:58:03.211 [main] DEBUG es.tfg.votacion.service.AuthService - JWT signing key initialized with HS256 algorithm
2025-11-11 01:58:03.211 [main] INFO  es.tfg.votacion.service.AuthService - JWT signing key initialized successfully
2025-11-11 01:58:03.219 [main] DEBUG es.tfg.votacion.service.AuthService - JWT issuer: votacion-test
2025-11-11 01:58:03.219 [main] DEBUG es.tfg.votacion.service.AuthService - JWT audience: test-system
2025-11-11 01:58:03.219 [main] DEBUG es.tfg.votacion.service.AuthService - JWT expiration: 3600 seconds
2025-11-11 01:58:03.219 [main] DEBUG es.tfg.votacion.service.AuthService - Allowed roles: [voter, admin, auditor]
2025-11-11 01:58:03.219 [main] WARN  es.tfg.votacion.service.AuthService - Running in MOCK authentication mode - not suitable for production!
2025-11-11 01:58:03.229 [main] INFO  e.t.votacion.service.ElectionService - Initializing ElectionService with mock elections
2025-11-11 01:58:03.232 [main] INFO  e.t.votacion.service.ElectionService - Created 3 mock elections
2025-11-11 01:58:03.261 [main] INFO  e.tfg.votacion.service.FabricService - Initializing Hyperledger Fabric Gateway connection
2025-11-11 01:58:03.261 [main] INFO  e.tfg.votacion.service.FabricService - Attempting to connect to Fabric network...
2025-11-11 01:58:03.261 [main] DEBUG e.tfg.votacion.service.FabricService - Connection profile: /home/ehuetadr/fabric/fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.json
2025-11-11 01:58:03.261 [main] DEBUG e.tfg.votacion.service.FabricService - Wallet path: /home/ehuetadr/TFG/VotacionBC/backend-spring/wallet
2025-11-11 01:58:03.261 [main] DEBUG e.tfg.votacion.service.FabricService - User: appUser
2025-11-11 01:58:03.261 [main] DEBUG e.tfg.votacion.service.FabricService - Channel: electionchannel
2025-11-11 01:58:03.262 [main] DEBUG e.tfg.votacion.service.FabricService - Chaincode: electioncc
2025-11-11 01:58:03.262 [main] WARN  e.tfg.votacion.service.FabricService - Using MOCK Fabric connection for PoC development
2025-11-11 01:58:03.262 [main] WARN  e.tfg.votacion.service.FabricService - To use real Fabric connection, implement proper Gateway initialization
2025-11-11 01:58:03.262 [main] INFO  e.tfg.votacion.service.FabricService - Successfully connected to Hyperledger Fabric network
2025-11-11 01:58:03.278 [main] INFO  e.t.votacion.service.StorageService - Initializing Storage Service with AES-GCM encryption
2025-11-11 01:58:03.279 [main] DEBUG e.t.votacion.service.StorageService - Loading encryption key from keystore: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/keystore/keystore.json
2025-11-11 01:58:03.279 [main] DEBUG e.t.votacion.service.StorageService - Keystore loaded - algorithm: AES/GCM/NoPadding, key length: 256 bits
2025-11-11 01:58:03.280 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded and validated successfully
2025-11-11 01:58:03.280 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded successfully from keystore
2025-11-11 01:58:03.280 [main] INFO  e.t.votacion.service.StorageService - Storage directory initialized: /home/ehuetadr/TFG/VotacionBC/backend-spring/data/storage
2025-11-11 01:58:03.280 [main] DEBUG e.t.votacion.service.StorageService - Encryption algorithm: AES/GCM/NoPadding
2025-11-11 01:58:03.280 [main] DEBUG e.t.votacion.service.StorageService - Key length: 256 bits
2025-11-11 01:58:03.281 [main] DEBUG e.t.votacion.service.StorageService - IV length: 12 bytes
2025-11-11 01:58:03.282 [main] DEBUG e.t.votacion.service.StorageService - Tag length: 128 bits
2025-11-11 01:58:03.282 [main] INFO  e.t.votacion.service.StorageService - Automatic cleanup enabled - retention: 30 days
2025-11-11 01:58:03.471 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 9b3c8199-d0ce-401b-bb6d-5b39c8f36143

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-11-11 01:58:03.473 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-11-11 01:58:03.481 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring Spring Security with JWT authentication
2025-11-11 01:58:03.481 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring CORS for development environment
2025-11-11 01:58:03.516 [main] INFO  e.tfg.votacion.config.SecurityConfig - Spring Security configured successfully
2025-11-11 01:58:03.864 [main] INFO  e.t.votacion.service.AuthServiceTest - Started AuthServiceTest in 1.435 seconds (process running for 13.723)
2025-11-11 01:58:03.913 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:04.207 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:04.214 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:04.346 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: invalid password for user: test.user
2025-11-11 01:58:04.352 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: non.existent.user
2025-11-11 01:58:04.353 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: user not found: non.existent.user
2025-11-11 01:58:04.368 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: lucia.garcia
2025-11-11 01:58:04.540 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: user is inactive: lucia.garcia
2025-11-11 01:58:04.547 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: username is null or empty
2025-11-11 01:58:04.548 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: password is null or empty
2025-11-11 01:58:04.548 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: username is null or empty
2025-11-11 01:58:04.561 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: username is null or empty
2025-11-11 01:58:04.561 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: password is null or empty
2025-11-11 01:58:04.562 [main] WARN  es.tfg.votacion.service.AuthService - Authentication failed: username is null or empty
2025-11-11 01:58:04.585 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:04.762 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:04.762 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: test.user
2025-11-11 01:58:04.962 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: test.user (expires: Tue Nov 11 02:58:04 CET 2025)
2025-11-11 01:58:04.981 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:05.115 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:05.116 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: test.user
2025-11-11 01:58:05.117 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: test.user (expires: Tue Nov 11 02:58:05 CET 2025)
2025-11-11 01:58:05.119 [main] DEBUG es.tfg.votacion.service.AuthService - Validating JWT token
2025-11-11 01:58:05.193 [main] DEBUG es.tfg.votacion.service.AuthService - JWT token validated successfully for user: test.user
2025-11-11 01:58:05.205 [main] DEBUG es.tfg.votacion.service.AuthService - Validating JWT token
2025-11-11 01:58:05.207 [main] WARN  es.tfg.votacion.service.AuthService - JWT validation failed: Malformed protected header JSON: Unable to deserialize: Unexpected character ('' (code 65533 / 0xfffd)): expected a valid value (JSON String, Number, Array, Object or token 'null', 'true' or 'false')
 at [Source: REDACTED (`StreamReadFeature.INCLUDE_SOURCE_IN_LOCATION` disabled); line: 1, column: 1]
2025-11-11 01:58:05.208 [main] WARN  es.tfg.votacion.service.AuthService - JWT validation failed: token is null or empty
2025-11-11 01:58:05.208 [main] WARN  es.tfg.votacion.service.AuthService - JWT validation failed: token is null or empty
2025-11-11 01:58:05.208 [main] WARN  es.tfg.votacion.service.AuthService - JWT validation failed: token is null or empty
2025-11-11 01:58:05.213 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:05.359 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:05.359 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: test.user
2025-11-11 01:58:05.361 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: test.user (expires: Tue Nov 11 02:58:05 CET 2025)
2025-11-11 01:58:05.377 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:05.520 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:05.521 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: admin
2025-11-11 01:58:05.648 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: admin (role: Administrador (admin))
2025-11-11 01:58:05.648 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: auditor
2025-11-11 01:58:05.772 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: auditor (role: Auditor (auditor))
2025-11-11 01:58:05.772 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user test.user: has role Votante (voter)? true
2025-11-11 01:58:05.772 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user test.user: has role Administrador (admin)? false
2025-11-11 01:58:05.772 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user test.user: has role Auditor (auditor)? false
2025-11-11 01:58:05.772 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user admin: has role Administrador (admin)? true
2025-11-11 01:58:05.772 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user admin: has role Votante (voter)? false
2025-11-11 01:58:05.773 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user admin: has role Auditor (auditor)? false
2025-11-11 01:58:05.773 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user auditor: has role Auditor (auditor)? true
2025-11-11 01:58:05.773 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user auditor: has role Votante (voter)? false
2025-11-11 01:58:05.773 [main] DEBUG es.tfg.votacion.service.AuthService - Role check for user auditor: has role Administrador (admin)? false
2025-11-11 01:58:05.784 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:05.907 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:05.908 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: admin
2025-11-11 01:58:06.009 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: admin (role: Administrador (admin))
2025-11-11 01:58:06.009 [main] DEBUG es.tfg.votacion.service.AuthService - User test.user has role Votante (voter)
2025-11-11 01:58:06.009 [main] DEBUG es.tfg.votacion.service.AuthService - User admin has role Administrador (admin)
2025-11-11 01:58:06.009 [main] DEBUG es.tfg.votacion.service.AuthService - User test.user does not have any of the required roles
2025-11-11 01:58:06.013 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:06.136 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:06.200 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: admin
2025-11-11 01:58:06.308 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: admin (role: Administrador (admin))
2025-11-11 01:58:06.309 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: admin
2025-11-11 01:58:06.309 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: admin (expires: Tue Nov 11 02:58:06 CET 2025)
2025-11-11 01:58:06.309 [main] DEBUG es.tfg.votacion.service.AuthService - Validating JWT token
2025-11-11 01:58:06.310 [main] DEBUG es.tfg.votacion.service.AuthService - JWT token validated successfully for user: admin
2025-11-11 01:58:06.315 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: juan.perez
2025-11-11 01:58:06.432 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: juan.perez (role: Votante (voter))
2025-11-11 01:58:06.432 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: maria.gonzalez
2025-11-11 01:58:06.524 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: maria.gonzalez (role: Votante (voter))
2025-11-11 01:58:06.524 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: admin
2025-11-11 01:58:06.627 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: admin (role: Administrador (admin))
2025-11-11 01:58:06.627 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: juan.perez
2025-11-11 01:58:06.628 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: juan.perez (expires: Tue Nov 11 02:58:06 CET 2025)
2025-11-11 01:58:06.629 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: maria.gonzalez
2025-11-11 01:58:06.629 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: maria.gonzalez (expires: Tue Nov 11 02:58:06 CET 2025)
2025-11-11 01:58:06.629 [main] DEBUG es.tfg.votacion.service.AuthService - Generating JWT token for user: admin
2025-11-11 01:58:06.630 [main] INFO  es.tfg.votacion.service.AuthService - JWT token generated for user: admin (expires: Tue Nov 11 02:58:06 CET 2025)
2025-11-11 01:58:06.630 [main] DEBUG es.tfg.votacion.service.AuthService - Validating JWT token
2025-11-11 01:58:06.631 [main] DEBUG es.tfg.votacion.service.AuthService - JWT token validated successfully for user: juan.perez
2025-11-11 01:58:06.631 [main] DEBUG es.tfg.votacion.service.AuthService - Validating JWT token
2025-11-11 01:58:06.632 [main] DEBUG es.tfg.votacion.service.AuthService - JWT token validated successfully for user: maria.gonzalez
2025-11-11 01:58:06.633 [main] DEBUG es.tfg.votacion.service.AuthService - Validating JWT token
2025-11-11 01:58:06.635 [main] DEBUG es.tfg.votacion.service.AuthService - JWT token validated successfully for user: admin
2025-11-11 01:58:06.642 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: test.user
2025-11-11 01:58:06.753 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: test.user (role: Votante (voter))
2025-11-11 01:58:06.753 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: TEST.USER
2025-11-11 01:58:06.852 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: TEST.USER (role: Votante (voter))
2025-11-11 01:58:06.852 [main] DEBUG es.tfg.votacion.service.AuthService - Attempting to authenticate user: Test.User
2025-11-11 01:58:06.953 [main] INFO  es.tfg.votacion.service.AuthService - User authenticated successfully: Test.User (role: Votante (voter))
2025-11-11 01:58:06.969 [main] INFO  o.s.t.c.s.AnnotationConfigContextLoaderUtils - Could not detect default configuration classes for test class [es.tfg.votacion.ApplicationTests]: ApplicationTests does not declare any static, non-private, non-final, nested classes annotated with @Configuration.
2025-11-11 01:58:06.982 [main] INFO  o.s.b.t.c.SpringBootTestContextBootstrapper - Found @SpringBootConfiguration es.tfg.votacion.Application for test class es.tfg.votacion.ApplicationTests
2025-11-11 01:58:07.068 [SpringApplicationShutdownHook] INFO  e.t.votacion.service.StorageService - Shutting down Storage Service
2025-11-11 01:58:07.068 [SpringApplicationShutdownHook] DEBUG e.t.votacion.service.StorageService - Master key cleared from memory
2025-11-11 01:58:07.076 [SpringApplicationShutdownHook] INFO  e.t.votacion.service.StorageService - Shutting down Storage Service
2025-11-11 01:58:07.077 [SpringApplicationShutdownHook] DEBUG e.t.votacion.service.StorageService - Master key cleared from memory
2025-11-11 01:58:07.078 [SpringApplicationShutdownHook] INFO  e.t.votacion.service.StorageService - Shutting down Storage Service
2025-11-11 01:58:07.079 [SpringApplicationShutdownHook] DEBUG e.t.votacion.service.StorageService - Master key cleared from memory
2025-11-11 01:58:07.080 [SpringApplicationShutdownHook] INFO  e.t.votacion.service.StorageService - Shutting down Storage Service
2025-11-11 01:58:07.080 [SpringApplicationShutdownHook] DEBUG e.t.votacion.service.StorageService - Master key cleared from memory
2025-11-11 02:01:07.068 [main] INFO  es.tfg.votacion.Application - Starting Application v0.0.1-SNAPSHOT using Java 21.0.8 with PID 1494726 (/home/ehuetadr/TFG/VotacionBC/backend-spring/target/votacion-0.0.1-SNAPSHOT.jar started by ehuetadr in /home/ehuetadr/TFG/VotacionBC/backend-spring)
2025-11-11 02:01:07.084 [main] DEBUG es.tfg.votacion.Application - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-11 02:01:07.086 [main] INFO  es.tfg.votacion.Application - No active profile set, falling back to 1 default profile: "default"
2025-11-11 02:01:09.894 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port 8080 (http)
2025-11-11 02:01:09.927 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2025-11-11 02:01:09.928 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/10.1.48]
2025-11-11 02:01:10.045 [main] INFO  o.a.c.c.C.[.[localhost].[/api/v1] - Initializing Spring embedded WebApplicationContext
2025-11-11 02:01:10.046 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 2771 ms
2025-11-11 02:01:10.213 [main] INFO  es.tfg.votacion.service.AuthService - Initializing Authentication Service (Mock Mode)
2025-11-11 02:01:10.214 [main] DEBUG es.tfg.votacion.service.AuthService - Loading mock users from: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 02:01:10.274 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: juan.perez (role: Votante (voter), active: true)
2025-11-11 02:01:10.280 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: maria.gonzalez (role: Votante (voter), active: true)
2025-11-11 02:01:10.281 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: admin (role: Administrador (admin), active: true)
2025-11-11 02:01:10.282 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: auditor (role: Auditor (auditor), active: true)
2025-11-11 02:01:10.282 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: carlos.martin (role: Votante (voter), active: true)
2025-11-11 02:01:10.285 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: ana.rodriguez (role: Votante (voter), active: true)
2025-11-11 02:01:10.286 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: pedro.lopez (role: Administrador (admin), active: true)
2025-11-11 02:01:10.298 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: lucia.garcia (role: Votante (voter), active: false)
2025-11-11 02:01:10.299 [main] DEBUG es.tfg.votacion.service.AuthService - Loaded user: test.user (role: Votante (voter), active: true)
2025-11-11 02:01:10.299 [main] INFO  es.tfg.votacion.service.AuthService - Loaded 9 mock users from /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/mock/users.json
2025-11-11 02:01:10.317 [main] DEBUG es.tfg.votacion.service.AuthService - JWT signing key initialized with HS256 algorithm
2025-11-11 02:01:10.318 [main] INFO  es.tfg.votacion.service.AuthService - JWT signing key initialized successfully
2025-11-11 02:01:10.318 [main] DEBUG es.tfg.votacion.service.AuthService - JWT issuer: votacion-blockchain-poc
2025-11-11 02:01:10.318 [main] DEBUG es.tfg.votacion.service.AuthService - JWT audience: voting-system
2025-11-11 02:01:10.318 [main] DEBUG es.tfg.votacion.service.AuthService - JWT expiration: 3600 seconds
2025-11-11 02:01:10.318 [main] DEBUG es.tfg.votacion.service.AuthService - Allowed roles: [voter, admin, auditor]
2025-11-11 02:01:10.319 [main] WARN  es.tfg.votacion.service.AuthService - Running in MOCK authentication mode - not suitable for production!
2025-11-11 02:01:09.030 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-11 02:01:09.152 [main] INFO  e.t.votacion.service.ElectionService - Initializing ElectionService with mock elections
2025-11-11 02:01:09.160 [main] INFO  e.t.votacion.service.ElectionService - Created 3 mock elections
2025-11-11 02:01:09.268 [main] INFO  e.tfg.votacion.service.FabricService - Initializing Hyperledger Fabric Gateway connection
2025-11-11 02:01:09.268 [main] INFO  e.tfg.votacion.service.FabricService - Attempting to connect to Fabric network...
2025-11-11 02:01:09.269 [main] DEBUG e.tfg.votacion.service.FabricService - Connection profile: /home/ehuetadr/fabric/fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.json
2025-11-11 02:01:09.282 [main] DEBUG e.tfg.votacion.service.FabricService - Wallet path: /home/ehuetadr/TFG/VotacionBC/backend-spring/wallet
2025-11-11 02:01:09.284 [main] DEBUG e.tfg.votacion.service.FabricService - User: appUser
2025-11-11 02:01:09.286 [main] DEBUG e.tfg.votacion.service.FabricService - Channel: electionchannel
2025-11-11 02:01:09.287 [main] DEBUG e.tfg.votacion.service.FabricService - Chaincode: electioncc
2025-11-11 02:01:09.287 [main] WARN  e.tfg.votacion.service.FabricService - Using MOCK Fabric connection for PoC development
2025-11-11 02:01:09.288 [main] WARN  e.tfg.votacion.service.FabricService - To use real Fabric connection, implement proper Gateway initialization
2025-11-11 02:01:09.288 [main] INFO  e.tfg.votacion.service.FabricService - Successfully connected to Hyperledger Fabric network
2025-11-11 02:01:09.355 [main] INFO  e.t.votacion.service.StorageService - Initializing Storage Service with AES-GCM encryption
2025-11-11 02:01:09.356 [main] DEBUG e.t.votacion.service.StorageService - Loading encryption key from keystore: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/keystore/keystore.json
2025-11-11 02:01:09.365 [main] DEBUG e.t.votacion.service.StorageService - Keystore loaded - algorithm: AES/GCM/NoPadding, key length: 256 bits
2025-11-11 02:01:09.367 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded and validated successfully
2025-11-11 02:01:09.368 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded successfully from keystore
2025-11-11 02:01:09.369 [main] INFO  e.t.votacion.service.StorageService - Storage directory initialized: /home/ehuetadr/TFG/VotacionBC/backend-spring/data/storage
2025-11-11 02:01:09.375 [main] DEBUG e.t.votacion.service.StorageService - Encryption algorithm: AES/GCM/NoPadding
2025-11-11 02:01:09.375 [main] DEBUG e.t.votacion.service.StorageService - Key length: 256 bits
2025-11-11 02:01:09.375 [main] DEBUG e.t.votacion.service.StorageService - IV length: 12 bytes
2025-11-11 02:01:09.375 [main] DEBUG e.t.votacion.service.StorageService - Tag length: 128 bits
2025-11-11 02:01:09.375 [main] INFO  e.t.votacion.service.StorageService - Automatic cleanup enabled - retention: 30 days
2025-11-11 02:01:10.215 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 829197fb-b244-4d47-b6c3-20d1a88e20db

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-11-11 02:01:10.245 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-11-11 02:01:10.462 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring Spring Security with JWT authentication
2025-11-11 02:01:10.465 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring CORS for development environment
2025-11-11 02:01:10.548 [main] INFO  e.tfg.votacion.config.SecurityConfig - Spring Security configured successfully
2025-11-11 02:01:11.154 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port 8080 (http) with context path '/api/v1'
2025-11-11 02:01:11.197 [main] INFO  es.tfg.votacion.Application - Started Application in 5.458 seconds (process running for 7.906)
2025-11-11 02:01:13.294 [SpringApplicationShutdownHook] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Commencing graceful shutdown. Waiting for active requests to complete
2025-11-11 02:01:13.311 [tomcat-shutdown] INFO  o.s.b.w.e.tomcat.GracefulShutdown - Graceful shutdown complete
2025-11-11 02:01:13.315 [SpringApplicationShutdownHook] INFO  e.t.votacion.service.StorageService - Shutting down Storage Service
2025-11-11 02:01:13.316 [SpringApplicationShutdownHook] DEBUG e.t.votacion.service.StorageService - Master key cleared from memory
