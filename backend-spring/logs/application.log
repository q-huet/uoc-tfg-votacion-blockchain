2025-11-12 23:59:42.945 [main] INFO  e.t.v.controller.AuthControllerTest - Starting AuthControllerTest using Java 21.0.8 with PID 13801 (started by ehuetadr in /home/ehuetadr/TFG/VotacionBC/backend-spring)
2025-11-12 23:59:42.950 [main] DEBUG e.t.v.controller.AuthControllerTest - Running with Spring Boot v3.5.7, Spring v6.2.12
2025-11-12 23:59:42.951 [main] INFO  e.t.v.controller.AuthControllerTest - No active profile set, falling back to 1 default profile: "default"
2025-11-12 23:59:45.427 [main] INFO  e.t.votacion.service.ElectionService - Initializing ElectionService with mock elections
2025-11-12 23:59:45.428 [main] INFO  e.t.votacion.service.ElectionService - Created 3 mock elections
2025-11-12 23:59:45.482 [main] INFO  e.tfg.votacion.service.FabricService - Initializing Hyperledger Fabric Gateway connection
2025-11-12 23:59:45.482 [main] INFO  e.tfg.votacion.service.FabricService - Attempting to connect to Fabric network...
2025-11-12 23:59:45.482 [main] DEBUG e.tfg.votacion.service.FabricService - Connection profile: /home/ehuetadr/fabric/fabric-samples/test-network/organizations/peerOrganizations/org1.example.com/connection-org1.json
2025-11-12 23:59:45.482 [main] DEBUG e.tfg.votacion.service.FabricService - Wallet path: /home/ehuetadr/TFG/VotacionBC/backend-spring/wallet
2025-11-12 23:59:45.483 [main] DEBUG e.tfg.votacion.service.FabricService - User: appUser
2025-11-12 23:59:45.483 [main] DEBUG e.tfg.votacion.service.FabricService - Channel: electionchannel
2025-11-12 23:59:45.483 [main] DEBUG e.tfg.votacion.service.FabricService - Chaincode: electioncc
2025-11-12 23:59:45.483 [main] WARN  e.tfg.votacion.service.FabricService - Using MOCK Fabric connection for PoC development
2025-11-12 23:59:45.483 [main] WARN  e.tfg.votacion.service.FabricService - To use real Fabric connection, implement proper Gateway initialization
2025-11-12 23:59:45.484 [main] INFO  e.tfg.votacion.service.FabricService - Successfully connected to Hyperledger Fabric network
2025-11-12 23:59:45.502 [main] INFO  e.t.votacion.service.StorageService - Initializing Storage Service with AES-GCM encryption
2025-11-12 23:59:45.503 [main] DEBUG e.t.votacion.service.StorageService - Loading encryption key from keystore: /home/ehuetadr/TFG/VotacionBC/backend-spring/src/main/resources/keystore/keystore.json
2025-11-12 23:59:45.527 [main] DEBUG e.t.votacion.service.StorageService - Keystore loaded - algorithm: AES/GCM/NoPadding, key length: 256 bits
2025-11-12 23:59:45.532 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded and validated successfully
2025-11-12 23:59:45.532 [main] INFO  e.t.votacion.service.StorageService - Encryption key loaded successfully from keystore
2025-11-12 23:59:45.533 [main] INFO  e.t.votacion.service.StorageService - Storage directory initialized: /home/ehuetadr/TFG/VotacionBC/backend-spring/data/storage
2025-11-12 23:59:45.533 [main] DEBUG e.t.votacion.service.StorageService - Encryption algorithm: AES/GCM/NoPadding
2025-11-12 23:59:45.533 [main] DEBUG e.t.votacion.service.StorageService - Key length: 256 bits
2025-11-12 23:59:45.533 [main] DEBUG e.t.votacion.service.StorageService - IV length: 12 bytes
2025-11-12 23:59:45.533 [main] DEBUG e.t.votacion.service.StorageService - Tag length: 128 bits
2025-11-12 23:59:45.534 [main] INFO  e.t.votacion.service.StorageService - Automatic cleanup enabled - retention: 30 days
2025-11-12 23:59:46.049 [main] WARN  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: 6ec262a9-66a6-47e2-81bc-057e9fb03424

This generated password is for development use only. Your security configuration must be updated before running your application in production.

2025-11-12 23:59:46.057 [main] INFO  o.s.s.c.a.a.c.InitializeUserDetailsBeanManagerConfigurer$InitializeUserDetailsManagerConfigurer - Global AuthenticationManager configured with UserDetailsService bean with name inMemoryUserDetailsManager
2025-11-12 23:59:46.110 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring Spring Security with JWT authentication
2025-11-12 23:59:46.115 [main] INFO  e.tfg.votacion.config.SecurityConfig - Configuring CORS for development environment
2025-11-12 23:59:46.172 [main] INFO  e.tfg.votacion.config.SecurityConfig - Spring Security configured successfully
2025-11-12 23:59:46.710 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - Filter 'jwtAuthenticationFilter' configured for use
2025-11-12 23:59:46.712 [main] INFO  o.s.b.t.m.w.SpringBootMockServletContext - Initializing Spring TestDispatcherServlet ''
2025-11-12 23:59:46.714 [main] INFO  o.s.t.w.s.TestDispatcherServlet - Initializing Servlet ''
2025-11-12 23:59:46.716 [main] INFO  o.s.t.w.s.TestDispatcherServlet - Completed initialization in 2 ms
2025-11-12 23:59:46.755 [main] INFO  e.t.v.controller.AuthControllerTest - Started AuthControllerTest in 4.346 seconds (process running for 5.881)
2025-11-12 23:59:46.864 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/validate - Full authentication is required to access this resource
2025-11-12 23:59:47.015 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/user - Full authentication is required to access this resource
2025-11-12 23:59:47.028 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/validate - Full authentication is required to access this resource
2025-11-12 23:59:47.382 [main] INFO  e.t.v.controller.AuthController - Login attempt for user: test.user from IP: 127.0.0.1
2025-11-12 23:59:47.386 [main] INFO  e.t.v.controller.AuthController - User authenticated successfully: test.user (role: Votante)
2025-11-12 23:59:47.442 [main] INFO  e.t.v.controller.AuthController - Login attempt for user: test.user from IP: 127.0.0.1
2025-11-12 23:59:47.451 [main] INFO  e.t.v.controller.AuthController - User authenticated successfully: test.user (role: Votante)
2025-11-12 23:59:47.474 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/validate - Full authentication is required to access this resource
2025-11-12 23:59:47.533 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - User 'test.user' authenticated successfully with role 'Votante (voter)'
2025-11-12 23:59:47.535 [main] DEBUG e.t.v.controller.AuthController - User info requested from IP: 127.0.0.1
2025-11-12 23:59:47.536 [main] DEBUG e.t.v.controller.AuthController - User info retrieved for: test.user
2025-11-12 23:59:47.583 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - User 'test.user' authenticated successfully with role 'Votante (voter)'
2025-11-12 23:59:47.585 [main] DEBUG e.t.v.controller.AuthController - Token validation requested from IP: 127.0.0.1
2025-11-12 23:59:47.585 [main] DEBUG e.t.v.controller.AuthController - Token validated successfully for user: test.user
2025-11-12 23:59:47.610 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/auth/login - Full authentication is required to access this resource
2025-11-12 23:59:47.642 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - Invalid JWT token for request to: /api/v1/auth/user
2025-11-12 23:59:47.643 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/user - Full authentication is required to access this resource
2025-11-12 23:59:47.695 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<?> es.tfg.votacion.controller.AuthController.login(es.tfg.votacion.dto.LoginRequest,jakarta.servlet.http.HttpServletRequest): [Field error in object 'loginRequest' on field 'username': rejected value []; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-11-12 23:59:47.712 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - User 'test.user' authenticated successfully with role 'Votante (voter)'
2025-11-12 23:59:47.713 [main] DEBUG e.t.v.controller.AuthController - Token validation requested from IP: 127.0.0.1
2025-11-12 23:59:47.713 [main] DEBUG e.t.v.controller.AuthController - Token validated successfully for user: test.user
2025-11-12 23:59:47.750 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - Invalid JWT token for request to: /api/v1/auth/validate
2025-11-12 23:59:47.750 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/validate - Full authentication is required to access this resource
2025-11-12 23:59:47.817 [main] INFO  e.t.v.controller.AuthController - Login attempt for user: nonexistent from IP: 127.0.0.1
2025-11-12 23:59:47.819 [main] WARN  e.t.v.controller.AuthController - Authentication failed for user: nonexistent
2025-11-12 23:59:47.859 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/v1/auth/logout - Full authentication is required to access this resource
2025-11-12 23:59:47.903 [main] INFO  e.t.v.controller.AuthController - Login attempt for user: TEST.USER from IP: 127.0.0.1
2025-11-12 23:59:47.905 [main] INFO  e.t.v.controller.AuthController - User authenticated successfully: test.user (role: Votante)
2025-11-12 23:59:47.965 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.http.converter.HttpMessageNotReadableException: JSON parse error: Unexpected character ('i' (code 105)): was expecting double-quote to start field name]
2025-11-12 23:59:47.975 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<?> es.tfg.votacion.controller.AuthController.login(es.tfg.votacion.dto.LoginRequest,jakarta.servlet.http.HttpServletRequest) with 2 errors: [Field error in object 'loginRequest' on field 'password': rejected value [null]; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] [Field error in object 'loginRequest' on field 'username': rejected value [null]; codes [NotBlank.loginRequest.username,NotBlank.username,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.username,username]; arguments []; default message [username]]; default message [Username is required]] ]
2025-11-12 23:59:48.007 [main] ERROR e.t.v.c.JwtAuthenticationEntryPoint - Unauthorized access attempt to: /api/auth/login - Full authentication is required to access this resource
2025-11-12 23:59:48.059 [main] DEBUG e.t.v.config.JwtAuthenticationFilter - User 'test.user' authenticated successfully with role 'Votante (voter)'
2025-11-12 23:59:48.061 [main] INFO  e.t.v.controller.AuthController - User logged out: null from IP: 127.0.0.1
2025-11-12 23:59:48.105 [main] INFO  e.t.v.controller.AuthController - Login attempt for user: test.user from IP: 127.0.0.1
2025-11-12 23:59:48.107 [main] WARN  e.t.v.controller.AuthController - Authentication failed for user: test.user
2025-11-12 23:59:48.142 [main] WARN  o.s.w.s.m.s.DefaultHandlerExceptionResolver - Resolved [org.springframework.web.bind.MethodArgumentNotValidException: Validation failed for argument [0] in public org.springframework.http.ResponseEntity<?> es.tfg.votacion.controller.AuthController.login(es.tfg.votacion.dto.LoginRequest,jakarta.servlet.http.HttpServletRequest): [Field error in object 'loginRequest' on field 'password': rejected value []; codes [NotBlank.loginRequest.password,NotBlank.password,NotBlank.java.lang.String,NotBlank]; arguments [org.springframework.context.support.DefaultMessageSourceResolvable: codes [loginRequest.password,password]; arguments []; default message [password]]; default message [Password is required]] ]
2025-11-12 23:59:48.318 [SpringApplicationShutdownHook] INFO  e.t.votacion.service.StorageService - Shutting down Storage Service
2025-11-12 23:59:48.318 [SpringApplicationShutdownHook] DEBUG e.t.votacion.service.StorageService - Master key cleared from memory
