<div class="results-container">
  <p-toast></p-toast>

  <p-card *ngIf="results" [header]="'Resultados: ' + results.title" styleClass="results-card">
    <div class="grid">
      <div class="col-12 md:col-6 flex justify-content-center">
        <p-chart type="pie" [data]="chartData" [options]="chartOptions" width="300px" height="300px"></p-chart>
      </div>

      <div class="col-12 md:col-6">
        <div class="mb-3">
          <span class="text-xl font-bold">Total Votos: </span>
          <span class="text-xl">{{results.totalVotes}}</span>
        </div>

        <p-table [value]="results.results" styleClass="p-datatable-sm">
          <ng-template pTemplate="header">
            <tr>
              <th>Opci√≥n</th>
              <th>Votos</th>
              <th>Porcentaje</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-option>
            <tr>
              <td>{{option.label}}</td>
              <td>{{option.votes}}</td>
              <td>{{option.percentage | number:'1.1-2'}}%</td>
            </tr>
          </ng-template>
        </p-table>

        <div class="mt-4 p-3 surface-100 border-round">
          <div class="text-sm text-500 mb-1">Audit Trail (Blockchain)</div>
          <div class="text-xs font-mono" style="word-break: break-all;">{{results.auditTrail}}</div>
        </div>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <div class="flex justify-content-end">
        <button pButton label="Volver" icon="pi pi-arrow-left" (click)="goBack()"></button>
      </div>
    </ng-template>
  </p-card>

  <div *ngIf="loading" class="flex justify-content-center align-items-center" style="height: 300px;">
    <i class="pi pi-spin pi-spinner" style="font-size: 2rem"></i>
  </div>
</div>
